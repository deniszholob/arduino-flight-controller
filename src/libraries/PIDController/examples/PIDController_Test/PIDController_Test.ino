/* ===================================
 * PID Controller Library
 * ===================================
 * Tests the PID Controller Library
 * Prints out input, forse and calculated output.
 * 
 * @author Denis Zholob
 */

// ================================================================================================================
// Importing Libraries
// ================================================================================================================
#include "PIDController.h"

// ================================================================================================================
// Declaring Constants (Magic numbers are BAD!)
// ================================================================================================================
#define SAMPLES 32


// ================================================================================================================
// Declaring Variables
// ================================================================================================================

int inputs[SAMPLES] = {0};
int measured[SAMPLES] = {
  0,  // 00
  10, // 01
  10, // 02
  10, // 03
  10, // 04
  10, // 05
  10, // 06
  10, // 07
  10, // 08
  10, // 09
  10, // 10
  10, // 11
  10, // 12
  10, // 13
  10, // 14
  0,  // 15
  0,  // 16
  0,  // 17
  -20,// 18
  -20,// 19
  -20,// 20
  -20,// 21
  -10,// 22
  -10,// 23
  -10,// 24
  -10,// 25
  0,  // 26
  0,  // 27
  0,  // 28
  -10,// 29
  -10,// 30
  -10// 31
};
int output[SAMPLES] = {0};

// ================================================================================================================
// Declaring Objects
// ================================================================================================================
PIDController Pid_Control;


// ================================================================================================================
// Setup routine: Runs once when you press reset or power on the board
// ================================================================================================================
void setup() {
  // Open the serial port and set the baud rate to 9600
  Serial.begin(9600);

  // Set P,I, and D gains
  Pid_Control.setPgain(1);
  Pid_Control.setIgain(1);
  Pid_Control.setDgain(1);

  // Run PID control against data
  testPID();

}

// ================================================================================================================
// Main program loop: Runs over and over again forever
// ================================================================================================================
void loop() {
	// Nothing in loop
}


// ================================================================================================================
// Functions
// ================================================================================================================

// Run PID control against data in for loop to simulate actual program loop
void testPID(){
  for (int i = 0; i < SAMPLES; ++i) {
  	output[i] = Pid_Control.pidCalc(inputs[i], measured[i]);
  	Serial.print("Input: ");
  	Serial.print(inputs[i]);
  	Serial.print("	Force: ");
  	Serial.print(measured[i]);
  	Serial.print("	Output: ");
  	Serial.println(output[i]);
  }
}

